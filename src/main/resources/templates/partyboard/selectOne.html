<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
    <div th:replace="~{layout::boottemplate}"></div>

    <script th:inline="javascript">
    // 팝업 열기 함수
    function openPopup(url, name, width = 600, height = 400) {
        const left = (window.screen.width / 2) - (width / 2);
        const top = (window.screen.height / 2) - (height / 2);
        window.open(url, name, `width=${width},height=${height},left=${left},top=${top}`);
    }

    // 버튼 클릭 시 팝업 열기 처리 함수
    function handlePopup(action, id) {
        let url;
        let name;

        switch (action) {
            case 'update':
                url = `/partyboard/update?party_board_id=${id}`;
                name = 'updateparty';
                openPopup(url, name, 600, 900);
                break;
            case 'delete':
                url = `/partyboard/delete?party_board_id=${id}`;
                name = 'deleteparty';
                openPopup(url, name);
                break;
            case 'apply':
                url = `/partylist/application?party_id=${id}`;
                name = 'Applicationparty';
                openPopup(url, name, 600, 150);
                break;
            default:
                console.error('Unknown action:', action);
        }
    }
    </script>

   <style>
    th, td {
        text-align: center; /* 가로 중앙 정렬 */
        vertical-align: middle; /* 세로 중앙 정렬 */
    }
    
   .content-cell {
        vertical-align: top; /* 위쪽 정렬 */
        padding-top: 20px; /* 위쪽 여백 */
        padding-bottom: 20px; /* 아래쪽 여백 */
        min-height: 150px; /* 기본 높이 설정 */
        word-break: break-word; /* 긴 텍스트 줄바꿈 */
    }
     header .party_boardview_head {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }

    .title {
        font-size: 24px;
        font-weight: bold;
        margin-top: 15px; /* 위쪽 간격 조절 */
        margin-bottom: 10px; /* 아래쪽 간격 조절 */
    }

    .party_board_writer {
        display: flex;
        align-items: center;
    }

    .party_board_writer .nickname {
        margin-right: 10px;
        font-weight: bold;
    }

    .party_board_writer .party_board_date {
        color: #888;
        font-size: 12px;
        margin-right:10px;
    }

    .party_boardview_head .fr span {
        margin-left: 10px;
    }

    .content {
        padding: 20px;
        line-height: 1.6;
        word-break: break-word;
    }
    
    .writing_view_box {
        width: 100%;  /* 부모 컨테이너에 맞게 너비 100% */
        min-height: 300px; /* 최소 높이 설정 */
        padding: 10px;
        border: 1px solid #ddd; /* 테두리 추가 */
        border-radius: 8px;
        background-color: #f8f9fa;
        white-space: pre-wrap; /* 텍스트 줄바꿈 */
        word-break: break-word; /* 단어가 길 때 줄바꿈 */
        overflow: hidden; /* 스크롤 숨김 */
    }
    .boss-easy {
        color: rgb(195, 195, 215); /* 이지 */
        font-weight: bold;
    }
    .boss-normal {
        color: rgb(51, 170, 197); /* 노멀 */
        font-weight: bold;
    }
    .boss-hard {
        color: rgb(194, 58, 62); /* 하드 */
        font-weight: bold;
    }
    .boss-chaos {
        color: rgb(255, 221, 187); /* 카오스 */
        font-weight: bold;
    }
    .boss-extreme {
        color: rgb(238, 68, 85); /* 익스트림 */
        font-weight: bold;
    }
    
    .button-comment{
    display: flex;
    justify-content: flex-end; /* 오른쪽 정렬 */
    }
     .comment-row {
            display: flex;
            justify-content: space-between; /* 작성자 왼쪽, 본문 가운데, 작성일 오른쪽 정렬 */
            padding: 10px 0;
            border-bottom: 1px solid #ddd; /* 각 댓글 구분선 */
        }

        .comment-author {
            flex: 1;
            text-align: left;
        }

        .comment-content {
            flex: 3;
            text-align: center;
            word-break: break-word; /* 본문이 길 경우 자동 줄바꿈 */
        }

        .comment-date {
            flex: 1;
            text-align: right;
        }

        .comment-actions {
              display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 10px;
    gap: 10px; /* 버튼 사이 간격 */
            
        }
</style>
</head>

<body th:replace="~{layout::layout}">
<div th:fragment="content" class="gtco-container">
    <header>
        <div class="party_boardview_head clear ub-content">
            <h3 class="title ub-word">
                <span class="title_subject" th:text="${vo3.party_name}"></span>
            </h3>
            <div class="party_board_writer">
                <div class="fl">
                    <span class="nickname in" th:text="${vo2.party_board_writer}">작성자</span>
                    <span class="party_board_date" th:text="${vo2.party_board_wdate}">작성일</span>
                </div>
                <div class="btn-container">
                    <button type="button" class="btn btn-primary"
                        th:onclick="|handlePopup('apply', ${vo2.party_id})|">
                        파티 참가 신청
                    </button>
                </div>
            </div>
        </div>
    </header>

    <hr>

    <div class="content">
        <p><strong>요구 전투력:</strong> <span th:text="${vo2.req_pwr}"></span></p>
        <p><strong>공략 보스:</strong>
            <span th:text="${vo2.boss}" th:classappend="
                ${vo2.boss.contains('이지')} ? 'boss-easy' : 
                (${vo2.boss.contains('노멀')} ? 'boss-normal' : 
                (${vo2.boss.contains('하드')} ? 'boss-hard' : 
                (${vo2.boss.contains('카오스')} ? 'boss-chaos' : 
                (${vo2.boss.contains('익스트림')} ? 'boss-extreme' : ''))))"></span>
        </p>
        <p><strong>세부 내용:</strong></p>
        <div class="writing_view_box">
            <p th:text="${vo2.party_board_content}"></p>
        </div>
    </div>

    <div class="btn-container" th:if="${vo2.party_board_writer == session.user_character}">
        <button type="button" class="btn btn-warning"
            th:onclick="|handlePopup('update', ${vo2.party_board_id})|">게시글 수정</button>
        <button type="button" class="btn btn-danger"
            th:onclick="|handlePopup('delete', ${vo2.party_board_id})|">게시글 삭제</button>
    </div>

    <div th:replace="~{partyboardcomment/insert::commentinsert}"></div>
    <div th:replace="~{partyboardcomment/selectAll::commentselectAll}"></div>
</div>

</body>
</html>
